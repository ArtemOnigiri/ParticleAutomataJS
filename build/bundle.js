var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function c(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}function $(t,e,n){t.classList[n?"add":"remove"](e)}let y;function x(t){y=t}function b(t){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.after_update.push(t)}function v(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const w=[],k=[],M=[],S=[],_=Promise.resolve();let C=!1;function j(t){M.push(t)}function P(t){S.push(t)}let N=!1;const A=new Set;function E(){if(!N){N=!0;do{for(let t=0;t<w.length;t+=1){const e=w[t];x(e),F(e.$$)}for(x(null),w.length=0;k.length;)k.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];A.has(e)||(A.add(e),e())}M.length=0}while(w.length);for(;S.length;)S.pop()();C=!1,N=!1,A.clear()}}function F(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const L=new Set;let B;function q(t,e){t&&t.i&&(L.delete(t),t.i(e))}function I(t,e,n,o){if(t&&t.o){if(L.has(t))return;L.add(t),B.c.push((()=>{L.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}const O="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function R(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function T(t){t&&t.c()}function W(t,n,l,r){const{fragment:c,on_mount:i,on_destroy:a,after_update:u}=t.$$;c&&c.m(n,l),r||j((()=>{const n=i.map(e).filter(s);a?a.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(j)}function U(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function z(t,e){-1===t.$$.dirty[0]&&(w.push(t),C||(C=!0,_.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,s,l,r,c,i,u,f=[-1]){const d=y;x(e);const h=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:s.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:s.target||d.$$.root};u&&u(h.root);let p=!1;if(h.ctx=l?l(e,s.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return h.ctx&&c(h.ctx[t],h.ctx[t]=s)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](s),p&&z(e,t)),n})):[],h.update(),p=!0,o(h.before_update),h.fragment=!!r&&r(h.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);h.fragment&&h.fragment.l(t),t.forEach(a)}else h.fragment&&h.fragment.c();s.intro&&q(e.$$.fragment),W(e,s.target,s.anchor,s.customElement),E()}x(d)}class Y{$destroy(){U(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function H(e){let n,o,s;return{c(){n=u("canvas"),p(n,"width",e[0]),p(n,"height",e[1]),p(n,"class","svelte-6utq4t")},m(t,l){i(t,n,l),e[13](n),o||(s=h(n,"click",e[12]),o=!0)},p(t,[e]){1&e&&p(n,"width",t[0]),2&e&&p(n,"height",t[1])},i:t,o:t,d(t){t&&a(n),e[13](null),o=!1,s()}}}function D(t,e,n){let o,{width:s}=e,{height:l}=e,{links:r}=e,{fields:c}=e,{fw:i}=e,{fh:a}=e,{r:u}=e,{colors:f}=e,{drawConnections:d=!0}=e,{changeFormBySpeed:h=!0}=e,{displacementMultiplier:p=1}=e;return b((()=>{function t(t){const n=Math.atan2(t.y-t.lastY,t.x-t.lastX),o=Math.hypot(t.x-t.lastX,t.y-t.lastY);e.fillStyle=f[t.type]||"white",e.beginPath(),e.ellipse(t.x,t.y,Math.min(u*(Math.pow(o*p,2)+1),10),u,n,0,2*Math.PI),e.fill()}const e=o.getContext("2d");if(e.fillStyle="#141e46",e.fillRect(0,0,s,l),d)for(let t=0;t<r.length;t++){const n=r[t].a,o=r[t].b;e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y);const s=e.createLinearGradient(n.x,n.y,o.x,o.y);s.addColorStop(0,f[n.type]),s.addColorStop(1,f[o.type]),e.strokeStyle=s,e.lineWidth=Math.max(2*u-Math.hypot(n.x-o.x,n.y-o.y)/4,2),e.stroke()}for(let o=0;o<i;o++)for(let s=0;s<a;s++){const l=c[o][s];for(let o=0;o<l.length;o++){const s=l[o];h?t(s):(n=s,e.fillStyle=f[n.type]||"white",e.beginPath(),e.arc(n.x,n.y,u,0,2*Math.PI),e.fill())}}var n})),t.$$set=t=>{"width"in t&&n(0,s=t.width),"height"in t&&n(1,l=t.height),"links"in t&&n(3,r=t.links),"fields"in t&&n(4,c=t.fields),"fw"in t&&n(5,i=t.fw),"fh"in t&&n(6,a=t.fh),"r"in t&&n(7,u=t.r),"colors"in t&&n(8,f=t.colors),"drawConnections"in t&&n(9,d=t.drawConnections),"changeFormBySpeed"in t&&n(10,h=t.changeFormBySpeed),"displacementMultiplier"in t&&n(11,p=t.displacementMultiplier)},[s,l,o,r,c,i,a,u,f,d,h,p,function(e){v.call(this,t,e)},function(t){k[t?"unshift":"push"]((()=>{o=t,n(2,o)}))}]}class G extends Y{constructor(t){super(),X(this,t,D,H,l,{width:0,height:1,links:3,fields:4,fw:5,fh:6,r:7,colors:8,drawConnections:9,changeFormBySpeed:10,displacementMultiplier:11})}}function K(e){let n,s,l,r,$,y,x,b,v;return{c(){n=u("label"),s=u("div"),l=f(e[1]),r=f(": "),$=f(e[0]),y=d(),x=u("input"),p(s,"class","svelte-9fgmxq"),p(x,"type","range"),p(x,"min",e[2]),p(x,"max",e[3]),p(x,"step",e[4]),p(x,"class","svelte-9fgmxq"),p(n,"class","wrapper svelte-9fgmxq")},m(t,o){i(t,n,o),c(n,s),c(s,l),c(s,r),c(s,$),c(n,y),c(n,x),g(x,e[0]),b||(v=[h(x,"change",e[5]),h(x,"input",e[5])],b=!0)},p(t,[e]){2&e&&m(l,t[1]),1&e&&m($,t[0]),4&e&&p(x,"min",t[2]),8&e&&p(x,"max",t[3]),16&e&&p(x,"step",t[4]),1&e&&g(x,t[0])},i:t,o:t,d(t){t&&a(n),b=!1,o(v)}}}function J(t,e,n){let{name:o}=e,{min:s=0}=e,{max:l=100}=e,{value:r=s}=e,{step:c=1}=e;return t.$$set=t=>{"name"in t&&n(1,o=t.name),"min"in t&&n(2,s=t.min),"max"in t&&n(3,l=t.max),"value"in t&&n(0,r=t.value),"step"in t&&n(4,c=t.step)},[r,o,s,l,c,function(){r=function(t){return""===t?null:+t}(this.value),n(0,r)}]}class Q extends Y{constructor(t){super(),X(this,t,J,K,l,{name:1,min:2,max:3,value:0,step:4})}}function V(e){let n,o,s,l,r,g,$;return{c(){n=u("label"),o=u("input"),s=d(),l=u("span"),r=f(e[1]),p(o,"type","checkbox"),p(o,"class","svelte-120bdfb"),p(l,"class","svelte-120bdfb"),p(n,"class","svelte-120bdfb")},m(t,a){i(t,n,a),c(n,o),o.checked=e[0],c(n,s),c(n,l),c(l,r),g||($=h(o,"change",e[2]),g=!0)},p(t,[e]){1&e&&(o.checked=t[0]),2&e&&m(r,t[1])},i:t,o:t,d(t){t&&a(n),g=!1,$()}}}function Z(t,e,n){let{title:o}=e,{checked:s=!1}=e;return t.$$set=t=>{"title"in t&&n(1,o=t.title),"checked"in t&&n(0,s=t.checked)},[s,o,function(){s=this.checked,n(0,s)}]}class tt extends Y{constructor(t){super(),X(this,t,Z,V,l,{title:1,checked:0})}}function et(t,e,n){const o=t.slice();return o[3]=e[n],o}function nt(t){let e,n,o,s;function l(){return t[2](t[3])}return{c(){e=u("button"),p(e,"name","color"),p(e,"type","radio"),p(e,"style",n=`background-color: ${t[3][1]};`),p(e,"class","svelte-5i7tqo"),$(e,"selected",t[0]===t[3][0])},m(t,n){i(t,e,n),o||(s=h(e,"click",l),o=!0)},p(o,s){t=o,2&s&&n!==(n=`background-color: ${t[3][1]};`)&&p(e,"style",n),3&s&&$(e,"selected",t[0]===t[3][0])},d(t){t&&a(e),o=!1,s()}}}function ot(e){let n,o=Array(...e[1].entries()),s=[];for(let t=0;t<o.length;t+=1)s[t]=nt(et(e,o,t));return{c(){n=u("div");for(let t=0;t<s.length;t+=1)s[t].c();p(n,"class","wrapper svelte-5i7tqo")},m(t,e){i(t,n,e);for(let t=0;t<s.length;t+=1)s[t].m(n,null)},p(t,[e]){if(3&e){let l;for(o=Array(...t[1].entries()),l=0;l<o.length;l+=1){const r=et(t,o,l);s[l]?s[l].p(r,e):(s[l]=nt(r),s[l].c(),s[l].m(n,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=o.length}},i:t,o:t,d(t){t&&a(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(s,t)}}}function st(t,e,n){let{colors:o=[]}=e,{selectedId:s=0}=e;return t.$$set=t=>{"colors"in t&&n(1,o=t.colors),"selectedId"in t&&n(0,s=t.selectedId)},[s,o,t=>n(0,s=t[0])]}class lt extends Y{constructor(t){super(),X(this,t,st,ot,l,{colors:1,selectedId:0})}}const rt=[];var ct={showSettings:{en:"Show settings",ru:"Показать настройки"},hideSettings:{en:"Hide settings",ru:"Скрыть настройки"},copyLink:{en:"Copy link",ru:"Копировать ссылку"},currentWorldSettings:{en:"Current world settings",ru:"Настройки мира"},simulationsPerFrame:{en:"Simulations per frame",ru:"Шагов симуляции за кадр"},temperature:{en:"Temperature",ru:"Температура"},friction:{en:"Anti-friction",ru:"Анти-трение"},killAllParticles:{en:"Kill all particles",ru:"Уничтожить все частицы"},newWorldSettings:{en:"New world settings",ru:"Настройки нового мира"},particleTypesAmount:{en:"Particle types amount",ru:"Кол-во видов (цветов) частиц"},particleCount:{en:"Particle count",ru:"Кол-во частиц"},createNewWorld:{en:"Create new world",ru:"Создать новый мир"},particleBrush:{en:"Particle brush",ru:"Кисть частиц"},graphicalSettings:{en:"Graphical settings",ru:"Настройки просмотра"},drawConnections:{en:"Draw connections",ru:"Отображать соединения"},particleRadius:{en:"Particle radius",ru:"Радиус частицы"},changeFormBySpeed:{en:"Change particle form by speed",ru:"Искажать форму частицы в зависимости от скорости"},displacementMultiplier:{en:"Displacement multiplier",ru:"Множитель искажения"}};const{window:it}=O;function at(e){let n,o,s;return{c(){n=u("button"),n.textContent=`${e[16](e[17],"showSettings")}`,p(n,"class","svelte-1s4knjn")},m(t,l){i(t,n,l),o||(s=h(n,"click",e[39]),o=!0)},p:t,i:t,o:t,d(t){t&&a(n),o=!1,s()}}}function ut(t){let e,n,s,l,r,f,m,g,$,y,x,b,v,w,M,S,_,C,j,N,A,E,F,L,B,O,z,X,Y,H,D,G,K,J,V,Z,et,nt,ot,st,rt,ct,it,at,ut,ft,dt,ht,pt,mt,gt,$t,yt,xt,bt,vt;function wt(e){t[28](e)}let kt={name:t[16](t[17],"simulationsPerFrame"),min:1,max:100};function Mt(e){t[29](e)}void 0!==t[14]&&(kt.value=t[14]),y=new Q({props:kt}),k.push((()=>R(y,"value",wt)));let St={name:t[16](t[17],"temperature"),min:.1,max:40,step:.1};function _t(e){t[30](e)}void 0!==t[5]&&(St.value=t[5]),v=new Q({props:St}),k.push((()=>R(v,"value",Mt)));let Ct={name:t[16](t[17],"friction"),min:0,max:1,step:.01};function jt(e){t[31](e)}void 0!==t[7]&&(Ct.value=t[7]),S=new Q({props:Ct}),k.push((()=>R(S,"value",_t)));let Pt={name:t[16](t[17],"particleRadius"),min:3,max:10,step:.01};function Nt(e){t[33](e)}void 0!==t[3]&&(Pt.value=t[3]),j=new Q({props:Pt}),k.push((()=>R(j,"value",jt)));let At={name:t[16](t[17],"particleTypesAmount"),min:1,max:t[18].length};function Et(e){t[34](e)}void 0!==t[15]&&(At.value=t[15]),X=new Q({props:At}),k.push((()=>R(X,"value",Nt)));let Ft={name:t[16](t[17],"particleCount"),min:0,max:5e3};function Lt(e){t[35](e)}void 0!==t[4]&&(Ft.value=t[4]),D=new Q({props:Ft}),k.push((()=>R(D,"value",Et)));let Bt={colors:t[18].slice(0,t[11].length)};function qt(e){t[36](e)}void 0!==t[6]&&(Bt.selectedId=t[6]),st=new lt({props:Bt}),k.push((()=>R(st,"selectedId",Lt)));let It={title:t[16](t[17],"drawConnections")};function Ot(e){t[37](e)}void 0!==t[8]&&(It.checked=t[8]),ft=new tt({props:It}),k.push((()=>R(ft,"checked",qt)));let Rt={title:t[16](t[17],"changeFormBySpeed")};function Tt(e){t[38](e)}void 0!==t[9]&&(Rt.checked=t[9]),pt=new tt({props:Rt}),k.push((()=>R(pt,"checked",Ot)));let Wt={name:t[16](t[17],"displacementMultiplier"),min:1,max:10,step:1};return void 0!==t[10]&&(Wt.value=t[10]),$t=new Q({props:Wt}),k.push((()=>R($t,"value",Tt))),{c(){e=u("div"),n=u("div"),s=u("button"),s.textContent=`${t[16](t[17],"hideSettings")}`,l=d(),r=u("button"),r.textContent=`${t[16](t[17],"copyLink")}`,f=d(),m=u("div"),g=u("h2"),g.textContent=`${t[16](t[17],"currentWorldSettings")}`,$=d(),T(y.$$.fragment),b=d(),T(v.$$.fragment),M=d(),T(S.$$.fragment),C=d(),T(j.$$.fragment),A=d(),E=u("div"),F=u("button"),F.textContent=`${t[16](t[17],"killAllParticles")}`,L=d(),B=u("div"),O=u("h2"),O.textContent=`${t[16](t[17],"newWorldSettings")}`,z=d(),T(X.$$.fragment),H=d(),T(D.$$.fragment),K=d(),J=u("div"),V=u("button"),V.textContent=`${t[16](t[17],"createNewWorld")}`,Z=d(),et=u("div"),nt=u("h2"),nt.textContent=`${t[16](t[17],"particleBrush")}`,ot=d(),T(st.$$.fragment),ct=d(),it=u("div"),at=u("h2"),at.textContent=`${t[16](t[17],"graphicalSettings")}`,ut=d(),T(ft.$$.fragment),ht=d(),T(pt.$$.fragment),gt=d(),T($t.$$.fragment),p(s,"class","svelte-1s4knjn"),p(r,"class","svelte-1s4knjn"),p(n,"class","buttons-row svelte-1s4knjn"),p(e,"class","controls-block svelte-1s4knjn"),p(g,"class","controls-block__title svelte-1s4knjn"),p(F,"class","svelte-1s4knjn"),p(E,"class","buttons-row svelte-1s4knjn"),p(m,"class","controls-block svelte-1s4knjn"),p(O,"class","controls-block__title svelte-1s4knjn"),p(V,"class","svelte-1s4knjn"),p(J,"class","buttons-row svelte-1s4knjn"),p(B,"class","controls-block svelte-1s4knjn"),p(nt,"class","controls-block__title svelte-1s4knjn"),p(et,"class","controls-block svelte-1s4knjn"),p(at,"class","controls-block__title svelte-1s4knjn"),p(it,"class","controls-block svelte-1s4knjn")},m(o,a){i(o,e,a),c(e,n),c(n,s),c(n,l),c(n,r),i(o,f,a),i(o,m,a),c(m,g),c(m,$),W(y,m,null),c(m,b),W(v,m,null),c(m,M),W(S,m,null),c(m,C),W(j,m,null),c(m,A),c(m,E),c(E,F),i(o,L,a),i(o,B,a),c(B,O),c(B,z),W(X,B,null),c(B,H),W(D,B,null),c(B,K),c(B,J),c(J,V),i(o,Z,a),i(o,et,a),c(et,nt),c(et,ot),W(st,et,null),i(o,ct,a),i(o,it,a),c(it,at),c(it,ut),W(ft,it,null),c(it,ht),W(pt,it,null),c(it,gt),W($t,it,null),xt=!0,bt||(vt=[h(s,"click",t[27]),h(r,"click",t[23]),h(F,"click",t[32]),h(V,"click",t[22])],bt=!0)},p(t,e){const n={};!x&&16384&e[0]&&(x=!0,n.value=t[14],P((()=>x=!1))),y.$set(n);const o={};!w&&32&e[0]&&(w=!0,o.value=t[5],P((()=>w=!1))),v.$set(o);const s={};!_&&128&e[0]&&(_=!0,s.value=t[7],P((()=>_=!1))),S.$set(s);const l={};!N&&8&e[0]&&(N=!0,l.value=t[3],P((()=>N=!1))),j.$set(l);const r={};!Y&&32768&e[0]&&(Y=!0,r.value=t[15],P((()=>Y=!1))),X.$set(r);const c={};!G&&16&e[0]&&(G=!0,c.value=t[4],P((()=>G=!1))),D.$set(c);const i={};2048&e[0]&&(i.colors=t[18].slice(0,t[11].length)),!rt&&64&e[0]&&(rt=!0,i.selectedId=t[6],P((()=>rt=!1))),st.$set(i);const a={};!dt&&256&e[0]&&(dt=!0,a.checked=t[8],P((()=>dt=!1))),ft.$set(a);const u={};!mt&&512&e[0]&&(mt=!0,u.checked=t[9],P((()=>mt=!1))),pt.$set(u);const f={};!yt&&1024&e[0]&&(yt=!0,f.value=t[10],P((()=>yt=!1))),$t.$set(f)},i(t){xt||(q(y.$$.fragment,t),q(v.$$.fragment,t),q(S.$$.fragment,t),q(j.$$.fragment,t),q(X.$$.fragment,t),q(D.$$.fragment,t),q(st.$$.fragment,t),q(ft.$$.fragment,t),q(pt.$$.fragment,t),q($t.$$.fragment,t),xt=!0)},o(t){I(y.$$.fragment,t),I(v.$$.fragment,t),I(S.$$.fragment,t),I(j.$$.fragment,t),I(X.$$.fragment,t),I(D.$$.fragment,t),I(st.$$.fragment,t),I(ft.$$.fragment,t),I(pt.$$.fragment,t),I($t.$$.fragment,t),xt=!1},d(t){t&&a(e),t&&a(f),t&&a(m),U(y),U(v),U(S),U(j),t&&a(L),t&&a(B),U(X),U(D),t&&a(Z),t&&a(et),U(st),t&&a(ct),t&&a(it),U(ft),U(pt),U($t),bt=!1,o(vt)}}}function ft(t){let e,n,s,l,r,f,m,g,y;j(t[25]),n=new G({props:{width:t[0],height:t[1],fields:t[13],links:t[12],fw:t[19],fh:t[20],r:t[3],drawConnections:t[8],changeFormBySpeed:t[9],displacementMultiplier:t[10],colors:t[18]}}),n.$on("click",t[26]);const x=[ut,at],b=[];function v(t,e){return t[2]?0:1}return r=v(t),f=b[r]=x[r](t),{c(){e=u("main"),T(n.$$.fragment),s=d(),l=u("div"),f.c(),p(l,"class","controls svelte-1s4knjn"),$(l,"controls_opened",t[2])},m(o,a){i(o,e,a),W(n,e,null),c(e,s),c(e,l),b[r].m(l,null),m=!0,g||(y=h(it,"resize",t[25]),g=!0)},p(t,e){const s={};1&e[0]&&(s.width=t[0]),2&e[0]&&(s.height=t[1]),8192&e[0]&&(s.fields=t[13]),4096&e[0]&&(s.links=t[12]),8&e[0]&&(s.r=t[3]),256&e[0]&&(s.drawConnections=t[8]),512&e[0]&&(s.changeFormBySpeed=t[9]),1024&e[0]&&(s.displacementMultiplier=t[10]),n.$set(s);let c=r;r=v(t),r===c?b[r].p(t,e):(B={r:0,c:[],p:B},I(b[c],1,1,(()=>{b[c]=null})),B.r||o(B.c),B=B.p,f=b[r],f?f.p(t,e):(f=b[r]=x[r](t),f.c()),q(f,1),f.m(l,null)),4&e[0]&&$(l,"controls_opened",t[2])},i(t){m||(q(n.$$.fragment,t),q(f),m=!0)},o(t){I(n.$$.fragment,t),I(f),m=!1},d(t){t&&a(e),U(n),b[r].d(),g=!1,y()}}}function dt(t,e){t.splice(t.indexOf(e),1)}function ht(e,n,o){let s;let c=window.innerWidth,i=window.innerHeight,a=new URLSearchParams(location.search).get("lang")||"en";let u=!0,f=Number(new URLSearchParams(location.search).get("radius"))||5,d=Number(new URLSearchParams(location.search).get("count"))||750,h=Number(new URLSearchParams(location.search).get("max_dist"))||100,p=Number(new URLSearchParams(location.search).get("temperature"))||4,m=0,g=Number(new URLSearchParams(location.search).get("friction"))||.98,$=!0,y=!0,x=1;const b=h*h;let v=c/h+1,w=i/h+1,k=3,M=[],S=[],_=[],C=[],j=[],P=function(e,n=t){let o;const s=new Set;function r(t){if(l(e,t)&&(e=t,o)){const t=!rt.length;for(const t of s)t[1](),rt.push(t,e);if(t){for(let t=0;t<rt.length;t+=2)rt[t][0](rt[t+1]);rt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(l,c=t){const i=[l,c];return s.add(i),1===s.size&&(o=n(r)||t),l(e),()=>{s.delete(i),0===s.size&&(o(),o=null)}}}}(3);r(e,P,(t=>o(15,s=t)));let N=5;if(location.hash){let t=location.hash.substring(1).split("-"),e=0;A=P,s=~~t[e],E=s,A.set(E),k=s,F(),e++;for(let n=0;n<k;n++)M[n]=Number(t[e])>>2*n&3;e++;for(let n=0;n<k;n++){for(let o=0;o<k;o++)S[n][o]=(Number(t[e])>>2*o&3)-1;e++}for(let n=0;n<k;n++){for(let o=0;o<k;o++)_[n][o]=Number(t[e])>>2*o&3;e++}history.pushState(null,null," ")}else F();var A,E;function F(){o(6,m=0),function(){k=s,M=[],o(11,S=[]),_=[];for(let t=0;t<k;t++){M.push(~~(4*Math.random())),S.push([]),_.push([]);for(let e=0;e<k;e++)S[t].push(Math.floor(3*Math.random()-1)),_[t].push(~~(4*Math.random()))}}(),function(){o(12,C=[]),o(13,j=[]);for(let t=0;t<v;t++){j.push([]);for(let e=0;e<w;e++)j[t].push([])}for(let t=0;t<d;t++)L(Math.random()*c,Math.random()*i,~~(Math.random()*k))}()}function L(t,e,n){let o={x:t,y:e,type:n,sx:0,sy:0,bonds:[]};const s=Math.floor(t/h),l=Math.floor(e/h);j[s][l].push(o)}function B(t,e){const n=t.x-e.x,o=t.y-e.y;let s=n*n+o*o;if(s<b){let n=S[t.type][e.type]/s,o=S[e.type][t.type]/s;if(t.bonds.length<M[t.type]&&e.bonds.length<M[e.type]){if(s<b/4&&-1===t.bonds.indexOf(e)&&-1===e.bonds.indexOf(t)){let n=0;t.bonds.forEach((t=>{t.type===e.type&&n++}));let o=0;e.bonds.forEach((e=>{e.type===t.type&&o++})),n<_[t.type][e.type]&&o<_[e.type][t.type]&&function(t,e){t.bonds.push(e),e.bonds.push(t),C.push({a:t,b:e})}(t,e)}}else-1===t.bonds.indexOf(e)&&-1===e.bonds.indexOf(t)&&(n=1/s,o=1/s);const l=Math.atan2(t.y-e.y,t.x-e.x);s<1&&(s=1),s<f*f*4&&(n=1/s,o=1/s),t.sx+=Math.cos(l)*n*p,t.sy+=Math.sin(l)*n*p,e.sx-=Math.cos(l)*o*p,e.sy-=Math.sin(l)*o*p}}function q(){for(let t=0;t<v;t++)for(let e=0;e<w;e++){const n=j[t][e];for(let t=0;t<n.length;t++){const e=n[t];e.lastX=e.x,e.lastY=e.y,e.x+=e.sx,e.y+=e.sy,e.sx*=g,e.sy*=g;const o=Math.sqrt(e.sx*e.sx+e.sy*e.sy);o>1&&(e.sx/=o,e.sy/=o),e.x<10?(e.sx+=.05*p,e.x<0&&(e.x=-e.x,e.sx*=-.5)):e.x>c-10&&(e.sx-=.05*p,e.x>c&&(e.x=2*c-e.x,e.sx*=-.5)),e.y<10?(e.sy+=.05*p,e.y<0&&(e.y=-e.y,e.sy*=-.5)):e.y>i-10&&(e.sy-=.05*p,e.y>i&&(e.y=2*i-e.y,e.sy*=-.5))}}for(let t=0;t<C.length;t++){const e=C[t],n=e.a,o=e.b,s=n.x-o.x,l=n.y-o.y;let r=s*s+l*l;if(r>b/4)dt(n.bonds,o),dt(o.bonds,n),dt(C,e),t--;else if(r>f*f*4){const t=Math.atan2(n.y-o.y,n.x-o.x),e=-.015;n.sx+=Math.cos(t)*e*p,n.sy+=Math.sin(t)*e*p,o.sx-=Math.cos(t)*e*p,o.sy-=Math.sin(t)*e*p}}for(let t=0;t<v;t++)for(let e=0;e<w;e++){const n=j[t][e];for(let o=0;o<n.length;o++){const s=n[o],l=Math.floor(s.x/h),r=Math.floor(s.y/h);l===t&&r===e||(dt(n,s),j[l][r].push(s))}}for(let t=0;t<v;t++)for(let e=0;e<w;e++){const n=j[t][e];for(let o=0;o<n.length;o++){const s=n[o];for(let t=o+1;t<n.length;t++){B(s,n[t])}if(t<v-1){const n=j[t+1][e];for(let t=0;t<n.length;t++){B(s,n[t])}}if(e<w-1){const n=e+1,o=j[t][n];for(let t=0;t<o.length;t++){B(s,o[t])}if(t<v-1){const e=j[t+1][n];for(let t=0;t<e.length;t++){B(s,e[t])}}}}}}requestAnimationFrame((function t(){for(let t=0;t<N;t++)q();o(13,j=[...j]),window.requestAnimationFrame(t)}));return[c,i,u,f,d,p,m,g,$,y,x,S,C,j,N,s,function(t,e){const n=ct[e];return Object.keys(n).includes(t)?n[t]:n.en},a,["#fa1414","#c88c64","#50aa8c","#0096e6","#0a14e6","#8200c8","#fa96d2","#828282","green","white"],v,w,P,F,function(){let t="";t+=k;let e=0;for(let t=0;t<k;t++)e|=M[t]<<2*t;t+="-"+e;for(let e=0;e<k;e++){let n=0;for(let t=0;t<k;t++)n|=S[e][t]+1<<2*t;t+="-"+n}for(let e=0;e<k;e++){let n=0;for(let t=0;t<k;t++)n|=_[e][t]<<2*t;t+="-"+n}t=window.location.href+"#"+t;let n=document.createElement("input");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)},L,function(){o(0,c=it.innerWidth),o(1,i=it.innerHeight)},t=>{L(t.clientX+Math.random()-.5,t.clientY+Math.random()-.5,m)},()=>o(2,u=!1),function(t){N=t,o(14,N)},function(t){p=t,o(5,p)},function(t){g=t,o(7,g)},function(t){f=t,o(3,f)},()=>{o(13,j=[]);for(let t=0;t<v;t++){j.push([]);for(let e=0;e<w;e++)j[t].push([])}o(12,C=[])},function(t){s=t,P.set(s)},function(t){d=t,o(4,d)},function(t){m=t,o(6,m)},function(t){$=t,o(8,$)},function(t){y=t,o(9,y)},function(t){x=t,o(10,x)},()=>o(2,u=!0)]}return new class extends Y{constructor(t){super(),X(this,t,ht,ft,l,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
