var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function l(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function c(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}function $(t,e,n){t.classList[n?"add":"remove"](e)}let y;function b(t){y=t}function x(t){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.after_update.push(t)}function v(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const w=[],k=[],M=[],S=[],C=Promise.resolve();let _=!1;function j(t){M.push(t)}function P(t){S.push(t)}let N=!1;const A=new Set;function E(){if(!N){N=!0;do{for(let t=0;t<w.length;t+=1){const e=w[t];b(e),F(e.$$)}for(b(null),w.length=0;k.length;)k.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];A.has(e)||(A.add(e),e())}M.length=0}while(w.length);for(;S.length;)S.pop()();_=!1,N=!1,A.clear()}}function F(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const L=new Set;let B;function q(){B={r:0,c:[],p:B}}function I(){B.r||o(B.c),B=B.p}function O(t,e){t&&t.i&&(L.delete(t),t.i(e))}function R(t,e,n,o){if(t&&t.o){if(L.has(t))return;L.add(t),B.c.push((()=>{L.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}const T="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function W(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function U(t){t&&t.c()}function z(t,n,s,r){const{fragment:c,on_mount:i,on_destroy:a,after_update:u}=t.$$;c&&c.m(n,s),r||j((()=>{const n=i.map(e).filter(l);a?a.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(j)}function X(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(t,e){-1===t.$$.dirty[0]&&(w.push(t),_||(_=!0,C.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(e,l,s,r,c,i,u,f=[-1]){const d=y;b(e);const p=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:l.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:l.target||d.$$.root};u&&u(p.root);let h=!1;if(p.ctx=s?s(e,l.props||{},((t,n,...o)=>{const l=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=l)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](l),h&&Y(e,t)),n})):[],p.update(),h=!0,o(p.before_update),p.fragment=!!r&&r(p.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);p.fragment&&p.fragment.l(t),t.forEach(a)}else p.fragment&&p.fragment.c();l.intro&&O(e.$$.fragment),z(e,l.target,l.anchor,l.customElement),E()}b(d)}class D{$destroy(){X(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function G(e){let n,o,l;return{c(){n=u("canvas"),h(n,"width",e[0]),h(n,"height",e[1]),h(n,"class","svelte-6utq4t")},m(t,s){i(t,n,s),e[13](n),o||(l=p(n,"click",e[12]),o=!0)},p(t,[e]){1&e&&h(n,"width",t[0]),2&e&&h(n,"height",t[1])},i:t,o:t,d(t){t&&a(n),e[13](null),o=!1,l()}}}const K="#141e46";function J(t,e,n){let o,{width:l}=e,{height:s}=e,{links:r}=e,{fields:c}=e,{fw:i}=e,{fh:a}=e,{r:u}=e,{colors:f}=e,{drawConnections:d=!0}=e,{changeFormBySpeed:p=!0}=e,{displacementMultiplier:h=1}=e;return document.body.style.backgroundColor=K,x((()=>{function t(t){const n=Math.atan2(t.y-t.lastY,t.x-t.lastX),o=Math.hypot(t.x-t.lastX,t.y-t.lastY);e.fillStyle=f[t.type]||"white",e.beginPath(),e.ellipse(t.x,t.y,Math.min(u*(Math.pow(o*h,2)+1),10),u,n,0,2*Math.PI),e.fill()}const e=o.getContext("2d");if(e.fillStyle=K,e.fillRect(0,0,l,s),d)for(let t=0;t<r.length;t++){const n=r[t].a,o=r[t].b;e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y);const l=e.createLinearGradient(n.x,n.y,o.x,o.y);l.addColorStop(0,f[n.type]),l.addColorStop(1,f[o.type]),e.strokeStyle=l,e.lineWidth=Math.max(2*u-Math.hypot(n.x-o.x,n.y-o.y)/4,2),e.stroke()}for(let o=0;o<i;o++)for(let l=0;l<a;l++){const s=c[o][l];for(let o=0;o<s.length;o++){const l=s[o];p?t(l):(n=l,e.fillStyle=f[n.type]||"white",e.beginPath(),e.arc(n.x,n.y,u,0,2*Math.PI),e.fill())}}var n})),t.$$set=t=>{"width"in t&&n(0,l=t.width),"height"in t&&n(1,s=t.height),"links"in t&&n(3,r=t.links),"fields"in t&&n(4,c=t.fields),"fw"in t&&n(5,i=t.fw),"fh"in t&&n(6,a=t.fh),"r"in t&&n(7,u=t.r),"colors"in t&&n(8,f=t.colors),"drawConnections"in t&&n(9,d=t.drawConnections),"changeFormBySpeed"in t&&n(10,p=t.changeFormBySpeed),"displacementMultiplier"in t&&n(11,h=t.displacementMultiplier)},[l,s,o,r,c,i,a,u,f,d,p,h,function(e){v.call(this,t,e)},function(t){k[t?"unshift":"push"]((()=>{o=t,n(2,o)}))}]}class Q extends D{constructor(t){super(),H(this,t,J,G,s,{width:0,height:1,links:3,fields:4,fw:5,fh:6,r:7,colors:8,drawConnections:9,changeFormBySpeed:10,displacementMultiplier:11})}}function V(e){let n,l,s,r,$,y,b,x,v;return{c(){n=u("label"),l=u("div"),s=f(e[1]),r=f(": "),$=f(e[0]),y=d(),b=u("input"),h(l,"class","svelte-9fgmxq"),h(b,"type","range"),h(b,"min",e[2]),h(b,"max",e[3]),h(b,"step",e[4]),h(b,"class","svelte-9fgmxq"),h(n,"class","wrapper svelte-9fgmxq")},m(t,o){i(t,n,o),c(n,l),c(l,s),c(l,r),c(l,$),c(n,y),c(n,b),g(b,e[0]),x||(v=[p(b,"change",e[5]),p(b,"input",e[5])],x=!0)},p(t,[e]){2&e&&m(s,t[1]),1&e&&m($,t[0]),4&e&&h(b,"min",t[2]),8&e&&h(b,"max",t[3]),16&e&&h(b,"step",t[4]),1&e&&g(b,t[0])},i:t,o:t,d(t){t&&a(n),x=!1,o(v)}}}function Z(t,e,n){let{name:o}=e,{min:l=0}=e,{max:s=100}=e,{value:r=l}=e,{step:c=1}=e;return t.$$set=t=>{"name"in t&&n(1,o=t.name),"min"in t&&n(2,l=t.min),"max"in t&&n(3,s=t.max),"value"in t&&n(0,r=t.value),"step"in t&&n(4,c=t.step)},[r,o,l,s,c,function(){r=function(t){return""===t?null:+t}(this.value),n(0,r)}]}class tt extends D{constructor(t){super(),H(this,t,Z,V,s,{name:1,min:2,max:3,value:0,step:4})}}function et(e){let n,o,l,s,r,g,$;return{c(){n=u("label"),o=u("input"),l=d(),s=u("span"),r=f(e[1]),h(o,"type","checkbox"),h(o,"class","svelte-1nwpgdl"),h(n,"class","svelte-1nwpgdl")},m(t,a){i(t,n,a),c(n,o),o.checked=e[0],c(n,l),c(n,s),c(s,r),g||($=p(o,"change",e[2]),g=!0)},p(t,[e]){1&e&&(o.checked=t[0]),2&e&&m(r,t[1])},i:t,o:t,d(t){t&&a(n),g=!1,$()}}}function nt(t,e,n){let{title:o}=e,{checked:l=!1}=e;return t.$$set=t=>{"title"in t&&n(1,o=t.title),"checked"in t&&n(0,l=t.checked)},[l,o,function(){l=this.checked,n(0,l)}]}class ot extends D{constructor(t){super(),H(this,t,nt,et,s,{title:1,checked:0})}}function lt(t,e,n){const o=t.slice();return o[3]=e[n],o}function st(t){let e,n,o,l;function s(){return t[2](t[3])}return{c(){e=u("button"),h(e,"name","color"),h(e,"type","radio"),h(e,"style",n=`background-color: ${t[3][1]};`),h(e,"class","svelte-5i7tqo"),$(e,"selected",t[0]===t[3][0])},m(t,n){i(t,e,n),o||(l=p(e,"click",s),o=!0)},p(o,l){t=o,2&l&&n!==(n=`background-color: ${t[3][1]};`)&&h(e,"style",n),3&l&&$(e,"selected",t[0]===t[3][0])},d(t){t&&a(e),o=!1,l()}}}function rt(e){let n,o=Array(...e[1].entries()),l=[];for(let t=0;t<o.length;t+=1)l[t]=st(lt(e,o,t));return{c(){n=u("div");for(let t=0;t<l.length;t+=1)l[t].c();h(n,"class","wrapper svelte-5i7tqo")},m(t,e){i(t,n,e);for(let t=0;t<l.length;t+=1)l[t].m(n,null)},p(t,[e]){if(3&e){let s;for(o=Array(...t[1].entries()),s=0;s<o.length;s+=1){const r=lt(t,o,s);l[s]?l[s].p(r,e):(l[s]=st(r),l[s].c(),l[s].m(n,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},i:t,o:t,d(t){t&&a(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(l,t)}}}function ct(t,e,n){let{colors:o=[]}=e,{selectedId:l=0}=e;return t.$$set=t=>{"colors"in t&&n(1,o=t.colors),"selectedId"in t&&n(0,l=t.selectedId)},[l,o,t=>n(0,l=t[0])]}class it extends D{constructor(t){super(),H(this,t,ct,rt,s,{colors:1,selectedId:0})}}const at=[];var ut={showSettings:{en:"Show settings",ru:"Показать настройки"},hideSettings:{en:"Hide settings",ru:"Скрыть настройки"},copyLink:{en:"Copy link",ru:"Копировать ссылку"},currentWorldSettings:{en:"Current world settings",ru:"Настройки мира"},simulationsPerFrame:{en:"Simulations per frame",ru:"Шагов симуляции за кадр"},temperature:{en:"Temperature",ru:"Температура"},friction:{en:"Anti-friction",ru:"Анти-трение"},killAllParticles:{en:"Kill all particles",ru:"Уничтожить все частицы"},newWorldSettings:{en:"New world settings",ru:"Настройки нового мира"},particleTypesAmount:{en:"Particle types amount",ru:"Кол-во видов (цветов) частиц"},particleCount:{en:"Particle count",ru:"Кол-во частиц"},createNewWorld:{en:"Create new world",ru:"Создать новый мир"},particleBrush:{en:"Particle brush",ru:"Кисть частиц"},graphicalSettings:{en:"Graphical settings",ru:"Настройки просмотра"},drawConnections:{en:"Draw connections",ru:"Отображать соединения"},particleRadius:{en:"Particle radius",ru:"Радиус частицы"},changeFormBySpeed:{en:"Change particle form by speed",ru:"Искажать форму частицы в зависимости от скорости"},displacementMultiplier:{en:"Displacement multiplier",ru:"Множитель искажения"}};const{window:ft}=T;function dt(e){let n,o,l;return{c(){n=u("button"),n.textContent=`${e[16](e[17],"showSettings")}`,h(n,"class","svelte-1uajobp")},m(t,s){i(t,n,s),o||(l=p(n,"click",e[39]),o=!0)},p:t,i:t,o:t,d(t){t&&a(n),o=!1,l()}}}function pt(t){let e,n,l,s,r,f,m,g,$,y,b,x,v,w,M,S,C,_,j,N,A,E,F,L,B,T,Y,H,D,G,K,J,Q,V,Z,et,nt,lt,st,rt,ct,at,ut,ft,dt,pt,mt,gt,$t,yt,bt,xt,vt,wt;function kt(e){t[28](e)}let Mt={name:t[16](t[17],"simulationsPerFrame"),min:1,max:100};function St(e){t[29](e)}void 0!==t[14]&&(Mt.value=t[14]),y=new tt({props:Mt}),k.push((()=>W(y,"value",kt)));let Ct={name:t[16](t[17],"temperature"),min:.1,max:40,step:.1};function _t(e){t[30](e)}void 0!==t[5]&&(Ct.value=t[5]),v=new tt({props:Ct}),k.push((()=>W(v,"value",St)));let jt={name:t[16](t[17],"friction"),min:0,max:1,step:.01};function Pt(e){t[31](e)}void 0!==t[7]&&(jt.value=t[7]),S=new tt({props:jt}),k.push((()=>W(S,"value",_t)));let Nt={name:t[16](t[17],"particleRadius"),min:3,max:10,step:.01};function At(e){t[33](e)}void 0!==t[3]&&(Nt.value=t[3]),j=new tt({props:Nt}),k.push((()=>W(j,"value",Pt)));let Et={name:t[16](t[17],"particleTypesAmount"),min:1,max:t[18].length};function Ft(e){t[34](e)}void 0!==t[15]&&(Et.value=t[15]),H=new tt({props:Et}),k.push((()=>W(H,"value",At)));let Lt={name:t[16](t[17],"particleCount"),min:0,max:5e3};function Bt(e){t[35](e)}void 0!==t[4]&&(Lt.value=t[4]),K=new tt({props:Lt}),k.push((()=>W(K,"value",Ft)));let qt={colors:t[18].slice(0,t[11].length)};function It(e){t[36](e)}void 0!==t[6]&&(qt.selectedId=t[6]),rt=new it({props:qt}),k.push((()=>W(rt,"selectedId",Bt)));let Ot={title:t[16](t[17],"drawConnections")};function Rt(e){t[37](e)}void 0!==t[8]&&(Ot.checked=t[8]),pt=new ot({props:Ot}),k.push((()=>W(pt,"checked",It)));let Tt={title:t[16](t[17],"changeFormBySpeed")};void 0!==t[9]&&(Tt.checked=t[9]),$t=new ot({props:Tt}),k.push((()=>W($t,"checked",Rt)));let Wt=t[9]&&ht(t);return{c(){e=u("div"),n=u("div"),l=u("button"),l.textContent=`${t[16](t[17],"hideSettings")}`,s=d(),r=u("button"),r.textContent=`${t[16](t[17],"copyLink")}`,f=d(),m=u("div"),g=u("h2"),g.textContent=`${t[16](t[17],"currentWorldSettings")}`,$=d(),U(y.$$.fragment),x=d(),U(v.$$.fragment),M=d(),U(S.$$.fragment),_=d(),U(j.$$.fragment),A=d(),E=u("div"),F=u("button"),F.textContent=`${t[16](t[17],"killAllParticles")}`,L=d(),B=u("div"),T=u("h2"),T.textContent=`${t[16](t[17],"newWorldSettings")}`,Y=d(),U(H.$$.fragment),G=d(),U(K.$$.fragment),Q=d(),V=u("div"),Z=u("button"),Z.textContent=`${t[16](t[17],"createNewWorld")}`,et=d(),nt=u("div"),lt=u("h2"),lt.textContent=`${t[16](t[17],"particleBrush")}`,st=d(),U(rt.$$.fragment),at=d(),ut=u("div"),ft=u("h2"),ft.textContent=`${t[16](t[17],"graphicalSettings")}`,dt=d(),U(pt.$$.fragment),gt=d(),U($t.$$.fragment),bt=d(),Wt&&Wt.c(),h(l,"class","svelte-1uajobp"),h(r,"class","svelte-1uajobp"),h(n,"class","buttons-row svelte-1uajobp"),h(e,"class","controls-block svelte-1uajobp"),h(g,"class","controls-block__title svelte-1uajobp"),h(F,"class","svelte-1uajobp"),h(E,"class","buttons-row svelte-1uajobp"),h(m,"class","controls-block svelte-1uajobp"),h(T,"class","controls-block__title svelte-1uajobp"),h(Z,"class","svelte-1uajobp"),h(V,"class","buttons-row svelte-1uajobp"),h(B,"class","controls-block svelte-1uajobp"),h(lt,"class","controls-block__title svelte-1uajobp"),h(nt,"class","controls-block svelte-1uajobp"),h(ft,"class","controls-block__title svelte-1uajobp"),h(ut,"class","controls-block svelte-1uajobp")},m(o,a){i(o,e,a),c(e,n),c(n,l),c(n,s),c(n,r),i(o,f,a),i(o,m,a),c(m,g),c(m,$),z(y,m,null),c(m,x),z(v,m,null),c(m,M),z(S,m,null),c(m,_),z(j,m,null),c(m,A),c(m,E),c(E,F),i(o,L,a),i(o,B,a),c(B,T),c(B,Y),z(H,B,null),c(B,G),z(K,B,null),c(B,Q),c(B,V),c(V,Z),i(o,et,a),i(o,nt,a),c(nt,lt),c(nt,st),z(rt,nt,null),i(o,at,a),i(o,ut,a),c(ut,ft),c(ut,dt),z(pt,ut,null),c(ut,gt),z($t,ut,null),c(ut,bt),Wt&&Wt.m(ut,null),xt=!0,vt||(wt=[p(l,"click",t[27]),p(r,"click",t[23]),p(F,"click",t[32]),p(Z,"click",t[22])],vt=!0)},p(t,e){const n={};!b&&16384&e[0]&&(b=!0,n.value=t[14],P((()=>b=!1))),y.$set(n);const o={};!w&&32&e[0]&&(w=!0,o.value=t[5],P((()=>w=!1))),v.$set(o);const l={};!C&&128&e[0]&&(C=!0,l.value=t[7],P((()=>C=!1))),S.$set(l);const s={};!N&&8&e[0]&&(N=!0,s.value=t[3],P((()=>N=!1))),j.$set(s);const r={};!D&&32768&e[0]&&(D=!0,r.value=t[15],P((()=>D=!1))),H.$set(r);const c={};!J&&16&e[0]&&(J=!0,c.value=t[4],P((()=>J=!1))),K.$set(c);const i={};2048&e[0]&&(i.colors=t[18].slice(0,t[11].length)),!ct&&64&e[0]&&(ct=!0,i.selectedId=t[6],P((()=>ct=!1))),rt.$set(i);const a={};!mt&&256&e[0]&&(mt=!0,a.checked=t[8],P((()=>mt=!1))),pt.$set(a);const u={};!yt&&512&e[0]&&(yt=!0,u.checked=t[9],P((()=>yt=!1))),$t.$set(u),t[9]?Wt?(Wt.p(t,e),512&e[0]&&O(Wt,1)):(Wt=ht(t),Wt.c(),O(Wt,1),Wt.m(ut,null)):Wt&&(q(),R(Wt,1,1,(()=>{Wt=null})),I())},i(t){xt||(O(y.$$.fragment,t),O(v.$$.fragment,t),O(S.$$.fragment,t),O(j.$$.fragment,t),O(H.$$.fragment,t),O(K.$$.fragment,t),O(rt.$$.fragment,t),O(pt.$$.fragment,t),O($t.$$.fragment,t),O(Wt),xt=!0)},o(t){R(y.$$.fragment,t),R(v.$$.fragment,t),R(S.$$.fragment,t),R(j.$$.fragment,t),R(H.$$.fragment,t),R(K.$$.fragment,t),R(rt.$$.fragment,t),R(pt.$$.fragment,t),R($t.$$.fragment,t),R(Wt),xt=!1},d(t){t&&a(e),t&&a(f),t&&a(m),X(y),X(v),X(S),X(j),t&&a(L),t&&a(B),X(H),X(K),t&&a(et),t&&a(nt),X(rt),t&&a(at),t&&a(ut),X(pt),X($t),Wt&&Wt.d(),vt=!1,o(wt)}}}function ht(t){let e,n,o;function l(e){t[38](e)}let s={name:t[16](t[17],"displacementMultiplier"),min:1,max:10,step:1};return void 0!==t[10]&&(s.value=t[10]),e=new tt({props:s}),k.push((()=>W(e,"value",l))),{c(){U(e.$$.fragment)},m(t,n){z(e,t,n),o=!0},p(t,o){const l={};!n&&1024&o[0]&&(n=!0,l.value=t[10],P((()=>n=!1))),e.$set(l)},i(t){o||(O(e.$$.fragment,t),o=!0)},o(t){R(e.$$.fragment,t),o=!1},d(t){X(e,t)}}}function mt(t){let e,n,o,l,s,r,f,m,g;j(t[25]),n=new Q({props:{width:t[0],height:t[1],fields:t[13],links:t[12],fw:t[19],fh:t[20],r:t[3],drawConnections:t[8],changeFormBySpeed:t[9],displacementMultiplier:t[10],colors:t[18]}}),n.$on("click",t[26]);const y=[pt,dt],b=[];function x(t,e){return t[2]?0:1}return s=x(t),r=b[s]=y[s](t),{c(){e=u("main"),U(n.$$.fragment),o=d(),l=u("div"),r.c(),h(l,"class","controls svelte-1uajobp"),$(l,"controls_opened",t[2])},m(r,a){i(r,e,a),z(n,e,null),c(e,o),c(e,l),b[s].m(l,null),f=!0,m||(g=p(ft,"resize",t[25]),m=!0)},p(t,e){const o={};1&e[0]&&(o.width=t[0]),2&e[0]&&(o.height=t[1]),8192&e[0]&&(o.fields=t[13]),4096&e[0]&&(o.links=t[12]),8&e[0]&&(o.r=t[3]),256&e[0]&&(o.drawConnections=t[8]),512&e[0]&&(o.changeFormBySpeed=t[9]),1024&e[0]&&(o.displacementMultiplier=t[10]),n.$set(o);let c=s;s=x(t),s===c?b[s].p(t,e):(q(),R(b[c],1,1,(()=>{b[c]=null})),I(),r=b[s],r?r.p(t,e):(r=b[s]=y[s](t),r.c()),O(r,1),r.m(l,null)),4&e[0]&&$(l,"controls_opened",t[2])},i(t){f||(O(n.$$.fragment,t),O(r),f=!0)},o(t){R(n.$$.fragment,t),R(r),f=!1},d(t){t&&a(e),X(n),b[s].d(),m=!1,g()}}}function gt(t,e){t.splice(t.indexOf(e),1)}function $t(e,n,o){let l;let c=window.innerWidth,i=window.innerHeight,a=new URLSearchParams(location.search).get("lang")||"en";let u=!0,f=Number(new URLSearchParams(location.search).get("radius"))||5,d=Number(new URLSearchParams(location.search).get("count"))||750,p=Number(new URLSearchParams(location.search).get("max_dist"))||100,h=Number(new URLSearchParams(location.search).get("temperature"))||4,m=0,g=Number(new URLSearchParams(location.search).get("friction"))||.98,$=!0,y=!0,b=1;const x=p*p;let v=c/p+1,w=i/p+1,k=3,M=[],S=[],C=[],_=[],j=[],P=function(e,n=t){let o;const l=new Set;function r(t){if(s(e,t)&&(e=t,o)){const t=!at.length;for(const t of l)t[1](),at.push(t,e);if(t){for(let t=0;t<at.length;t+=2)at[t][0](at[t+1]);at.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(s,c=t){const i=[s,c];return l.add(i),1===l.size&&(o=n(r)||t),s(e),()=>{l.delete(i),0===l.size&&(o(),o=null)}}}}(3);r(e,P,(t=>o(15,l=t)));let N=5;if(location.hash){let t=location.hash.substring(1).split("-"),e=0;A=P,l=~~t[e],E=l,A.set(E),k=l,F(),e++;for(let n=0;n<k;n++)M[n]=Number(t[e])>>2*n&3;e++;for(let n=0;n<k;n++){for(let o=0;o<k;o++)S[n][o]=(Number(t[e])>>2*o&3)-1;e++}for(let n=0;n<k;n++){for(let o=0;o<k;o++)C[n][o]=Number(t[e])>>2*o&3;e++}history.pushState(null,null," ")}else F();var A,E;function F(){o(6,m=0),function(){k=l,M=[],o(11,S=[]),C=[];for(let t=0;t<k;t++){M.push(~~(4*Math.random())),S.push([]),C.push([]);for(let e=0;e<k;e++)S[t].push(Math.floor(3*Math.random()-1)),C[t].push(~~(4*Math.random()))}}(),function(){o(12,_=[]),o(13,j=[]);for(let t=0;t<v;t++){j.push([]);for(let e=0;e<w;e++)j[t].push([])}for(let t=0;t<d;t++)L(Math.random()*c,Math.random()*i,~~(Math.random()*k))}()}function L(t,e,n){let o={x:t,y:e,type:n,sx:0,sy:0,bonds:[]};const l=Math.floor(t/p),s=Math.floor(e/p);j[l][s].push(o)}function B(t,e){const n=t.x-e.x,o=t.y-e.y;let l=n*n+o*o;if(l<x){let n=S[t.type][e.type]/l,o=S[e.type][t.type]/l;if(t.bonds.length<M[t.type]&&e.bonds.length<M[e.type]){if(l<x/4&&-1===t.bonds.indexOf(e)&&-1===e.bonds.indexOf(t)){let n=0;t.bonds.forEach((t=>{t.type===e.type&&n++}));let o=0;e.bonds.forEach((e=>{e.type===t.type&&o++})),n<C[t.type][e.type]&&o<C[e.type][t.type]&&function(t,e){t.bonds.push(e),e.bonds.push(t),_.push({a:t,b:e})}(t,e)}}else-1===t.bonds.indexOf(e)&&-1===e.bonds.indexOf(t)&&(n=1/l,o=1/l);const s=Math.atan2(t.y-e.y,t.x-e.x);l<1&&(l=1),l<f*f*4&&(n=1/l,o=1/l),t.sx+=Math.cos(s)*n*h,t.sy+=Math.sin(s)*n*h,e.sx-=Math.cos(s)*o*h,e.sy-=Math.sin(s)*o*h}}function q(){for(let t=0;t<v;t++)for(let e=0;e<w;e++){const n=j[t][e];for(let t=0;t<n.length;t++){const e=n[t];e.lastX=e.x,e.lastY=e.y,e.x+=e.sx,e.y+=e.sy,e.sx*=g,e.sy*=g;const o=Math.sqrt(e.sx*e.sx+e.sy*e.sy);o>1&&(e.sx/=o,e.sy/=o),e.x<10?(e.sx+=.05*h,e.x<0&&(e.x=-e.x,e.sx*=-.5)):e.x>c-10&&(e.sx-=.05*h,e.x>c&&(e.x=2*c-e.x,e.sx*=-.5)),e.y<10?(e.sy+=.05*h,e.y<0&&(e.y=-e.y,e.sy*=-.5)):e.y>i-10&&(e.sy-=.05*h,e.y>i&&(e.y=2*i-e.y,e.sy*=-.5))}}for(let t=0;t<_.length;t++){const e=_[t],n=e.a,o=e.b,l=n.x-o.x,s=n.y-o.y;let r=l*l+s*s;if(r>x/4)gt(n.bonds,o),gt(o.bonds,n),gt(_,e),t--;else if(r>f*f*4){const t=Math.atan2(n.y-o.y,n.x-o.x),e=-.015;n.sx+=Math.cos(t)*e*h,n.sy+=Math.sin(t)*e*h,o.sx-=Math.cos(t)*e*h,o.sy-=Math.sin(t)*e*h}}for(let t=0;t<v;t++)for(let e=0;e<w;e++){const n=j[t][e];for(let o=0;o<n.length;o++){const l=n[o],s=Math.floor(l.x/p),r=Math.floor(l.y/p);s===t&&r===e||(gt(n,l),j[s][r].push(l))}}for(let t=0;t<v;t++)for(let e=0;e<w;e++){const n=j[t][e];for(let o=0;o<n.length;o++){const l=n[o];for(let t=o+1;t<n.length;t++){B(l,n[t])}if(t<v-1){const n=j[t+1][e];for(let t=0;t<n.length;t++){B(l,n[t])}}if(e<w-1){const n=e+1,o=j[t][n];for(let t=0;t<o.length;t++){B(l,o[t])}if(t<v-1){const e=j[t+1][n];for(let t=0;t<e.length;t++){B(l,e[t])}}}}}}requestAnimationFrame((function t(){for(let t=0;t<N;t++)q();o(13,j=[...j]),window.requestAnimationFrame(t)}));return[c,i,u,f,d,h,m,g,$,y,b,S,_,j,N,l,function(t,e){const n=ut[e];return Object.keys(n).includes(t)?n[t]:n.en},a,["#fa1414","#c88c64","#50aa8c","#0096e6","#0a14e6","#8200c8","#fa96d2","#828282","green","white"],v,w,P,F,function(){let t="";t+=k;let e=0;for(let t=0;t<k;t++)e|=M[t]<<2*t;t+="-"+e;for(let e=0;e<k;e++){let n=0;for(let t=0;t<k;t++)n|=S[e][t]+1<<2*t;t+="-"+n}for(let e=0;e<k;e++){let n=0;for(let t=0;t<k;t++)n|=C[e][t]<<2*t;t+="-"+n}t=window.location.href+"#"+t;let n=document.createElement("input");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)},L,function(){o(0,c=ft.innerWidth),o(1,i=ft.innerHeight)},t=>{L(t.clientX+Math.random()-.5,t.clientY+Math.random()-.5,m)},()=>o(2,u=!1),function(t){N=t,o(14,N)},function(t){h=t,o(5,h)},function(t){g=t,o(7,g)},function(t){f=t,o(3,f)},()=>{o(13,j=[]);for(let t=0;t<v;t++){j.push([]);for(let e=0;e<w;e++)j[t].push([])}o(12,_=[])},function(t){l=t,P.set(l)},function(t){d=t,o(4,d)},function(t){m=t,o(6,m)},function(t){$=t,o(8,$)},function(t){y=t,o(9,y)},function(t){b=t,o(10,b)},()=>o(2,u=!0)]}return new class extends D{constructor(t){super(),H(this,t,$t,mt,s,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
